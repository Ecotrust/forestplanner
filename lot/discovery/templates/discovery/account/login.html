{% extends 'discovery/common/base.html' %}
{% load static %}

{% load i18n %}
{% load account %}

{% block content %}
<div class="container">
    <div class="row">
        <h1>Welcome back</h1>
    </div>
    {% if socialaccount.providers  %}
        <div class="row">
            <div class="well">
                <h4>Option 1 <span class="text-info">(<em>recommended</em>)</span></h4>
                <p>Sign in with one of your existing third party accounts.</p>
                <div class="socialaccount_ballot">
                    <ul class="socialaccount_providers">
                        {% include "socialaccount/snippets/provider_list.html" %}
                    </ul>
                </div>
            </div>
        </div>
    {% endif %}
        <div class="row">
            <form class="login" method="POST" action="/auth/login/">
                {% csrf_token %}
          <div class="form-group">
            <label for="username">Username</label>
            <input type="text" name="login" id="id_login" class="form-control" placeholder="Enter username" autocomplete="username">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">Password</label>
            <input type="password" name="password" id="id_password" class="form-control" placeholder="Enter password" autocomplete="current-password">
          </div>
          <div class="form-group form-check">
            <input type="checkbox" class="form-check-input" name="remember" id="id_remember">
            <label class="form-check-label" for="exampleCheck1">Remember Me</label>
          </div>
          <button type="submit" id="sign-in-submit" class="btn btn-primary">Log in</button>
        </form>
    </div>
    <div class="row mt-4">
        <div class="col">
            <a href="/discovery/auth/register/">Create an account</a>
        </div>
        <div class="col">
            <a href="/discovery/auth/reset/">Forgot username or password</a>
        </div>
        <div class="col">
            <!-- TODO: add link to TOS -->
            <a href="" id="tos-link">Terms of Service</a>
        </div>
    </div>
</div>
{% endblock content %}

{% block extra_foot_scripts %}

<script>
	$(document).ready(function(){
        $('.login').submit(validateLogin);
    });

    function validateLogin(){
        var $els = $('#id_login, #id_password'),
            invalid = [];

        $.each($els, function(i, el){
          if ($(el).val() === ""){
            $(el).closest('.control-group').addClass('error');
            invalid.push(el);
          } else {
            $(el).closest('.control-group').removeClass('error');
          }
        });

        if(invalid.length){
          return false;
        }
    }
</script>
{% endblock extra_foot_scripts %}
