{% extends 'landmapper/two-pane.html' %}
{% load static flatblocks %}

{% block content %}
  <div class="row align-items-stretch flex-grow-1 no-gutters">
    {% block content-panel %}
      <aside class="col-5" id="content-panel">
        {% flatblock aside_content evaluated=True %}
        {% block show_panel_buttons %}
          {% if show_panel_buttons %}
            <a href="{{ btn_back_href }}" class="btn btn-light" id="btn-content-panel-back">Back</a>
            <a href="#" class="btn btn-light {{ btn_next_disabled }}" id="btn-content-panel-next">Next</a>
          {% endif %}
        {% endblock show_panel_buttons %}
        <form id="form-property-name" class="d-none" action=" %}{{ btn_create_maps_href }}" method="post">
          <div class="form-group">
            <input type="text" name="property-name" class="form-control form-control-lg" id="property-name" placeholder="Please name your property" aria-label="property-name" aria-describedby="btn-create-maps" required />
          </div>
          <a href="#" class="btn btn-light" id="btn-content-panel-back">Back</a>
          <button form="form-property-name" class="btn btn-light" id="btn-create-maps">Create maps</button>
        </form>
      </aside>
    {% endblock content-panel %}
    {% block map-wrap %}
      <section class="col" id="map-wrap">
        {% block property-search %}
          <form role="search" id="property-search-form" action="{% url 'identify' %}" method="post">
            {% csrf_token %}
            <div class="input-group input-group-lg">
              <input type="search" name="q-address" class="form-control" id="property-search" placeholder="{{ q_address }}" aria-label="{{ q_address }}" aria-describedby="property-search-btn" required />
              <div class="input-group-append">
                <button form="property-search-form" class="btn" id="property-search-btn">Go</button>
              </div>
            </div>
          </form>
        {% endblock property-search %}
        <div id="map"></div>
      </section>
    {% endblock map-wrap %}
  </div>
{% endblock content %}

{% block footer_scripts %}
  {{ block.super }}
  <script>
    {% if coords %}
      var propertyCoords = {{ coords }};
      if (propertyCoords.length > 1) {
        // Flip coords around for OL
        console.log(propertyCoords)
        reprojectCoords = ol.proj.fromLonLat([propertyCoords[1],propertyCoords[0]])
        mapView.setCenter(reprojectCoords);
        mapView.setZoom(12);
      }
    {% endif %}
  </script>
{% endblock footer_scripts %}
