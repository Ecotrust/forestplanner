{% extends 'landmapper/two-pane.html' %}
{% load static flatblocks %}

{% block content %}
  <div class="row align-items-stretch flex-grow-1 no-gutters">
    {% block content-panel %}
      <aside class="col-5" id="content-panel">
        {% flatblock aside_content evaluated=True %}
        {% block show_panel_buttons %}
          {% if show_panel_buttons %}
            <a href="{{ btn_back_href }}" class="btn btn-light" id="btn-content-panel-back">Back</a>
            <a href="{{ btn_next_href }}" class="btn btn-light {{ btn_next_disabled }}" id="btn-content-panel-next">Next</a>
          {% endif %}
        {% endblock show_panel_buttons %}
      </aside>
    {% endblock content-panel %}
    {% block map-wrap %}
      <section class="col" id="map-wrap">
        {% block property-search %}
          <form role="search" id="property-search-form" action="{% url 'identify' %}" method="post">
            {% csrf_token %}
            <div class="input-group input-group-lg">
              <input type="search" id="property-search" class="form-control" name="q-address" placeholder="{{ q_address }}" aria-label="{{ q_address }}" aria-describedby="property-search-btn" required>
              <div class="input-group-append">
                <button id="property-search-btn" class="btn" form="property-search-form">Go</button>
              </div>
            </div>
          </form>
        {% endblock property-search %}
        <div id="map"></div>
      </section>
    {% endblock map-wrap %}
  </div>
{% endblock content %}

{% block footer_scripts %}
  {{ block.super }}
  <script>
    {% if coords %}
      var propertyCoords = {{ coords }};
      if (propertyCoords.length > 1) {
        // Flip coords around for OL
        console.log(propertyCoords)
        reprojectCoords = ol.proj.fromLonLat([propertyCoords[1],propertyCoords[0]])
        mapView.setCenter(reprojectCoords);
        mapView.setZoom(10);
      }
    {% endif %}
  </script>
{% endblock footer_scripts %}
